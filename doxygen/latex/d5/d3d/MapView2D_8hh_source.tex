\hypertarget{MapView2D_8hh_source}{}\doxysection{Map\+View2\+D.\+hh}
\label{MapView2D_8hh_source}\index{src/opengl/MapView2D.hh@{src/opengl/MapView2D.hh}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{preprocessor}{\#pragma once}}
\DoxyCodeLine{00002 }
\DoxyCodeLine{00003 \textcolor{preprocessor}{\#include <glm/glm.hpp>}}
\DoxyCodeLine{00004 }
\DoxyCodeLine{00005 \textcolor{preprocessor}{\#include "{}data/BlockMapLoader.hh"{}}}
\DoxyCodeLine{00006 \textcolor{preprocessor}{\#include "{}opengl/Canvas.hh"{}}}
\DoxyCodeLine{00007 \textcolor{preprocessor}{\#include "{}opengl/MultiShape2D.hh"{}}}
\DoxyCodeLine{00008 }
\DoxyCodeLine{00009 \textcolor{keyword}{class }\mbox{\hyperlink{classStyle}{Style}};}
\DoxyCodeLine{\Hypertarget{MapView2D_8hh_source_l00010}\mbox{\hyperlink{classMapView2D}{00010}} \textcolor{keyword}{class }\mbox{\hyperlink{classMapView2D}{MapView2D}} : \textcolor{keyword}{public} \mbox{\hyperlink{classShape}{Shape}} \{}
\DoxyCodeLine{00011  \textcolor{keyword}{private}:}
\DoxyCodeLine{00012   \textcolor{keyword}{const} \mbox{\hyperlink{classStyle}{Style}}* style;}
\DoxyCodeLine{00013   \textcolor{keywordtype}{float} centerX, centerY, scaleX, scaleY;}
\DoxyCodeLine{00014   glm::mat4 originalTransform;}
\DoxyCodeLine{00015   glm::mat4 transform;}
\DoxyCodeLine{00016   \textcolor{comment}{// pointer to map loader object has advantage of opaqueness in header file}}
\DoxyCodeLine{00017   \textcolor{comment}{// and we can have a null map and draw nothing, and change maps}}
\DoxyCodeLine{00018   \mbox{\hyperlink{classBlockMapLoader}{BlockMapLoader}}* bml;}
\DoxyCodeLine{00019   uint32\_t numIndicesToDraw;}
\DoxyCodeLine{00020 }
\DoxyCodeLine{00021  \textcolor{keyword}{public}:}
\DoxyCodeLine{00022   \textcolor{keywordtype}{void} setProjection() \{}
\DoxyCodeLine{00023     transform = glm::ortho(centerX -\/ scaleX, centerX + scaleX, centerY -\/ scaleY,}
\DoxyCodeLine{00024                            centerY + scaleY);}
\DoxyCodeLine{00025   \}}
\DoxyCodeLine{00026   \textcolor{keywordtype}{void} translate(\textcolor{keywordtype}{float} percentX, \textcolor{keywordtype}{float} percentY) \{}
\DoxyCodeLine{00027     centerX += percentX * scaleX;}
\DoxyCodeLine{00028     centerY += percentY * scaleY;}
\DoxyCodeLine{00029   \}}
\DoxyCodeLine{00030   \textcolor{keywordtype}{void} uniformZoom(\textcolor{keywordtype}{float} s) \{ scaleX *= s, scaleY *= s; \}}
\DoxyCodeLine{00031   \mbox{\hyperlink{classMapView2D}{MapView2D}}(\mbox{\hyperlink{classCanvas}{Canvas}}* parent, \textcolor{keyword}{const} \mbox{\hyperlink{classStyle}{Style}}* s, \mbox{\hyperlink{classBlockMapLoader}{BlockMapLoader}}* bml = \textcolor{keyword}{nullptr})}
\DoxyCodeLine{00032       : \mbox{\hyperlink{classShape}{Shape}}(parent), style(s), bml(bml), transform(1.0f) \{}
\DoxyCodeLine{00033     \textcolor{keyword}{const} \mbox{\hyperlink{structBlockMapLoader_1_1BoundRect}{BlockMapLoader::BoundRect}}\& bounds = bml-\/>getBlockMapHeader()-\/>bounds;}
\DoxyCodeLine{00034     \textcolor{keywordtype}{float} centerX = (bounds.xMin + bounds.xMax) * 0.5;}
\DoxyCodeLine{00035     \textcolor{keywordtype}{float} centerY = (bounds.yMin + bounds.yMax) * 0.5;}
\DoxyCodeLine{00036 }
\DoxyCodeLine{00037     \textcolor{keywordtype}{double} ySize = parent-\/>getHeight();}
\DoxyCodeLine{00038     \textcolor{keywordtype}{double} xSize = parent-\/>getWidth();}
\DoxyCodeLine{00039     \textcolor{keywordtype}{double} shiftX = -\/bounds.xMin * xSize / (bounds.xMax -\/ bounds.xMin);}
\DoxyCodeLine{00040     \textcolor{keywordtype}{double} shiftY = ySize + (bounds.yMin * ySize / (bounds.yMax -\/ bounds.yMin));}
\DoxyCodeLine{00041     \textcolor{keywordtype}{double} scaleX = xSize / (bounds.xMax -\/ bounds.xMin);}
\DoxyCodeLine{00042     \textcolor{keywordtype}{double} scaleY = -\/ySize / (bounds.yMax -\/ bounds.yMin);}
\DoxyCodeLine{00043 }
\DoxyCodeLine{00044     std::cout << \textcolor{stringliteral}{"{}shift: "{}} << shiftX << \textcolor{stringliteral}{"{} "{}} << shiftY << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00045     std::cout << \textcolor{stringliteral}{"{}scale: "{}} << scaleX << \textcolor{stringliteral}{"{} "{}} << scaleY << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00046 }
\DoxyCodeLine{00047 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{00048     transform = glm::mat4(1.0f);}
\DoxyCodeLine{00049     transform = glm::translate(transform, glm::vec3(shiftX, shiftY, 0));}
\DoxyCodeLine{00050     transform = glm::scale(transform, glm::vec3(scaleX, scaleY, 0));}
\DoxyCodeLine{00051 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00052     this-\/>centerX = -\/74, this-\/>centerY = 40;}
\DoxyCodeLine{00053     this-\/>scaleX = 70 / 2, this-\/>scaleY = 70 / 2;}
\DoxyCodeLine{00054     setProjection();}
\DoxyCodeLine{00055   \}}
\DoxyCodeLine{00056   glm::mat4\& getTransform() \{ \textcolor{keywordflow}{return} transform; \}}
\DoxyCodeLine{00057   \textcolor{keywordtype}{void} init() \textcolor{keyword}{override};}
\DoxyCodeLine{00058   \textcolor{keywordtype}{void} render() \textcolor{keyword}{override};}
\DoxyCodeLine{00059   \textcolor{keywordtype}{void} update() \textcolor{keyword}{override};}
\DoxyCodeLine{00060   \textcolor{keywordtype}{void} dump();}
\DoxyCodeLine{00061 \};}

\end{DoxyCode}
